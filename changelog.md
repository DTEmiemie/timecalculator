# Changelog

## 2025-10-23

- feat: 新增“格式化”功能与下拉清理模式
  - 智能清理（推荐）：去无序列表 → 规范化时间 → 提取时间段 → 去空行
  - 清理无序列表：移除 `-`、`*`、`•`、`- [ ]`、`- [x]` 等前缀
  - 规范化时间格式：将 `23：00~00：43`、`23:00—00:43` 等统一成 `23:00 - 00:43`
  - 仅提取时间段：每行保留首个 `hh:mm - hh:mm` 匹配
  - 移除空行：删除空白行

- feat: 支持跨天时间段解析与显示
  - 解析时若结束时间小于开始时间，按“次日”处理（+24h）
  - 展示为 `次日 hh:mm`，如 `23:32 - 次日 00:52`，时长正确计算为 `1时20分`

- fix: SSR 水合差异容错
  - 为 `<body>` 增加 `suppressHydrationWarning`，避免浏览器扩展注入属性导致的 hydration mismatch 报错

- chore: 调整“自定义格式化”默认模板
  - 由 `总共时间为：{{TotalTime}}，总积分为{{points}}` 调整为 `总共时间为：{{TotalTime}}，有 {{points}} 待结算`
  - 加入一次性迁移：若本地存储仍为旧默认，将自动更新为新默认（用户自定义模板不受影响）

## 2025-10-24

- ux: 调整积分显示策略（方案 A 默认生效）
  - 输入变更（手动编辑、格式化、点击“计算时间”）时默认隐藏积分，避免旧结果混淆
  - 积分卡片提供“清空积分”按钮，便于手动清除

- feat: 可选开关（B/C）
  - 保留过期结果提示（B）：开启后输入变更不隐藏结果，在积分卡片顶部提示“输入已变更，需重新计算”，并提供“重新计算/清空积分”
  - 自动更新积分（C）：开启后总时长变化时自动计算并刷新积分
  - 两项开关默认关闭；开关位置在“总计时间”卡片内、“计算积分”按钮下方

受影响文件：
- `src/app/page.tsx`

受影响文件：
- `src/app/page.tsx`
- `src/app/layout.tsx`

说明：
- 智能清理的处理顺序：去无序列表 → 规范化时间 → 提取时间段 → 去空行。
- 如需扩展更多清理策略（如提取全部时间段、排序去重、计算前自动清理），可在后续迭代中追加。
